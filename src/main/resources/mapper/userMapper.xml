<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
        PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.zcy.ssm.dao.UserDao">
    <resultMap id="UserBaseMap" type="com.zcy.ssm.entity.User">
        <id column="id" property="userId" jdbcType="BIGINT"/>
        <result column="userName" property="userName" jdbcType="VARCHAR"/>
        <result column="userPhone" property="userPhone" jdbcType="VARCHAR"/>
        <result column="userEmail" property="userEmail" jdbcType="VARCHAR"/>
        <result column="password" property="password" jdbcType="VARCHAR"/>
        <result column="createTime" property="createTime" jdbcType="DATE"/>
        <result column="modifyTime" property="modifyTime" jdbcType="DATE"/>
        <result column="isDelete" property="isDelete" jdbcType="SMALLINT"></result>
    </resultMap>
    <!--通过用户手机查询用户信息，查询手机号是否被注册-->
    <select id="selectUserByPhone" parameterType="String" resultMap="UserBaseMap">
select * from user where userPhone = #{userPhone} and isDelete = 0;
    </select>
    <!-- 插入用户信息，新用户注册-->
    <insert id="insertUser" parameterType="com.zcy.ssm.entity.User">
        <!-- mysql插入数据后，获取id -->
        <selectKey keyProperty="userId" resultType="String" order="AFTER">
            select LAST_INSERT_ID() as id
        </selectKey>

        insert into user(userName, userPhone, userEmail, password, createTime,modifyTime,isDelete)
        values(#{userName}, #{userPhone}, #{userEmail}, #{password},#{createTime},#{modifyTime},#{isDelete})
    </insert>
    <select id="selectUserByUserName" parameterType="String" resultMap="UserBaseMap">
    select * from user where userName = #{userName}
</select>


</mapper>